(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2299],{4922:(e,t,a)=>{"use strict";a.d(t,{default:()=>c});var r=a(5155),s=a(2115),l=a(5695),n=a(5109),o=a(8292),i=a(1891);function c(){let e=(0,l.useRouter)(),[t,a]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),[p,u]=(0,s.useState)("recent"),[x,b]=(0,s.useState)(""),[m,h]=(0,s.useState)(null),g=(0,n.hG)({extensions:[o.A,i.Ay],content:"",editorProps:{attributes:{class:"prose max-w-none focus:outline-none min-h-[400px] px-4 py-3"}},onUpdate:e=>{let{editor:t}=e;b(t.getHTML())}}),y=(0,s.useCallback)(async e=>{var t,a;e.preventDefault();let r=null==(a=e.dataTransfer)||null==(t=a.files)?void 0:t[0];if(!r||!r.type.startsWith("image/"))return;let s=new FormData;s.append("file",r);try{let e=await fetch("".concat("https://port-0-interflowerapi-m8majoul75b3ab86.sel4.cloudtype.app","/api/upload"),{method:"POST",body:s}),t=(await e.json()).url;null==g||g.chain().focus().setImage({src:t}).run()}catch(e){console.error("이미지 업로드 실패:",e)}},[g]);(0,s.useEffect)(()=>{if(!g)return;let e=document.querySelector(".tiptap");if(e)return e.addEventListener("drop",y),()=>{e.removeEventListener("drop",y)}},[g,y]);let f=async a=>{a.preventDefault();let r=new FormData;r.append("title",t),r.append("sub_title",c),r.append("category",p),r.append("content",x),m&&r.append("image",m);try{if(!(await fetch("".concat("https://port-0-interflowerapi-m8majoul75b3ab86.sel4.cloudtype.app","/news_add"),{method:"POST",body:r})).ok)throw Error("업로드 실패");alert("게시글이 등록되었습니다!"),e.push("/news")}catch(e){console.error("게시글 업로드 실패:",e),alert("업로드 중 문제가 발생했습니다.")}};return(0,r.jsx)("div",{className:"min-h-screen bg-white px-6 pt-28 pb-10",children:(0,r.jsxs)("form",{onSubmit:f,className:"max-w-4xl mx-auto border border-gray-200 bg-white rounded",children:[(0,r.jsx)("div",{className:"border-b px-6 py-4",children:(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"소식"})}),(0,r.jsxs)("div",{className:"px-6 py-4 border-b",children:[(0,r.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"분류"}),(0,r.jsxs)("select",{value:p,onChange:e=>u(e.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-200",children:[(0,r.jsx)("option",{value:"issues",children:"최근이슈"}),(0,r.jsx)("option",{value:"report",children:"보도자료"})]})]}),(0,r.jsxs)("div",{className:"px-6 py-4 border-b",children:[(0,r.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"제목"}),(0,r.jsx)("input",{type:"text",placeholder:"제목을 입력하세요",value:t,onChange:e=>a(e.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-200"})]}),(0,r.jsxs)("div",{className:"px-6 py-4 border-b",children:[(0,r.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"서브 타이틀"}),(0,r.jsx)("input",{type:"text",placeholder:"서브 타이틀을 입력하세요",value:c,onChange:e=>d(e.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-200"})]}),(0,r.jsxs)("div",{className:"px-6 pt-6",children:[(0,r.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"대표 이미지"}),(0,r.jsxs)("div",{className:"relative inline-block",children:[(0,r.jsx)("label",{htmlFor:"image-upload",className:"cursor-pointer inline-block px-4 py-2 bg-[#E34798] text-white rounded hover:bg-blue-600 text-sm",children:"이미지 선택"}),(0,r.jsx)("input",{id:"image-upload",type:"file",accept:"image/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&a.type.startsWith("image/")&&(h(a),e.target.value="")},className:"hidden"})]}),m&&(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["선택된 파일: ",m.name]})]}),(0,r.jsxs)("div",{className:"px-6 py-4 tiptap",children:[(0,r.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"내용"}),(0,r.jsx)("div",{className:"border border-gray-300 rounded",children:(0,r.jsx)(n.$Z,{editor:g})}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"※ 이미지는 드래그 앤 드롭으로도 추가할 수 있어요."})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3 px-6 py-4 border-t bg-gray-50",children:[(0,r.jsx)("button",{type:"button",onClick:()=>e.back(),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-100",children:"취소"}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-[#E34798] text-white rounded hover:bg-blue-700",children:"등록"})]})]})})}},8188:(e,t,a)=>{Promise.resolve().then(a.bind(a,4922))}},e=>{var t=t=>e(e.s=t);e.O(0,[5004,277,2980,8441,1684,7358],()=>t(8188)),_N_E=e.O()}]);