(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9126],{1469:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return i},getImageProps:function(){return d}});let l=r(8229),a=r(8883),n=r(3063),s=l._(r(1193));function d(e){let{props:t}=(0,a.getImgProps)(e,{defaultLoader:s.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let i=n.Image},3701:(e,t,r)=>{Promise.resolve().then(r.bind(r,4922))},4922:(e,t,r)=>{"use strict";r.d(t,{default:()=>o});var l=r(5155),a=r(2115),n=r(5695),s=r(6766),d=r(5109),i=r(8292),u=r(1891);function o(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)().get("id"),[r,o]=(0,a.useState)(""),[c,p]=(0,a.useState)(""),[f,x]=(0,a.useState)(""),[h,m]=(0,a.useState)(""),[b,g]=(0,a.useState)(""),[j,y]=(0,a.useState)(""),[v,w]=(0,a.useState)(null),[N,S]=(0,a.useState)(null),[_,C]=(0,a.useState)(!1),P=(0,d.hG)({extensions:[i.A,u.Ay],content:"",editorProps:{attributes:{class:"prose max-w-none focus:outline-none min-h-[300px] px-4 py-3"}},onUpdate:e=>{let{editor:t}=e;y(t.getHTML())}}),O=(0,a.useCallback)(async e=>{var t,r;e.preventDefault();let l=null==(r=e.dataTransfer)||null==(t=r.files)?void 0:t[0];if(!l||!l.type.startsWith("image/"))return;let a=new FormData;a.append("file",l);try{let e=await fetch("".concat("https://port-0-interflowerapi-m8majoul75b3ab86.sel4.cloudtype.app","/api/upload"),{method:"POST",body:a}),t=(await e.json()).url;null==P||P.chain().focus().setImage({src:t}).run()}catch(e){console.error("이미지 업로드 실패:",e)}},[P]);(0,a.useEffect)(()=>{if(!P)return;let e=document.querySelector(".tiptap");if(e)return e.addEventListener("drop",O),()=>{e.removeEventListener("drop",O)}},[P,O]),(0,a.useEffect)(()=>{if(v){let e=new FileReader;e.onloadend=()=>S(e.result),e.readAsDataURL(v)}else S(null)},[v]);let k=async l=>{if(l.preventDefault(),!t)return alert("잘못된 접근입니다.");C(!0);let a=new FormData;a.append("title",r),a.append("date",c),a.append("location",f),a.append("florists",h),a.append("content",j),a.append("description",b),v&&a.append("image",v);try{if(!(await fetch("".concat("https://port-0-interflowerapi-m8majoul75b3ab86.sel4.cloudtype.app","/acticontentAdd/").concat(t),{method:"POST",body:a})).ok)throw Error("저장 실패");alert("저장되었습니다."),e.push("/business/activities")}catch(e){console.error(e),alert("저장 중 오류가 발생했습니다.")}finally{C(!1)}};return(0,l.jsx)("form",{onSubmit:k,className:"min-h-screen bg-gray-100 px-4 pt-[80px] pb-16",children:(0,l.jsxs)("div",{className:"max-w-5xl mx-auto bg-white p-6 rounded-lg shadow-lg space-y-10",children:[(0,l.jsxs)("section",{className:"grid grid-cols-1 md:grid-cols-2 gap-12",children:[(0,l.jsx)("div",{className:"w-full aspect-[4/3] relative bg-gray-100 rounded overflow-hidden",children:N?(0,l.jsx)(s.default,{src:N,alt:"미리보기",fill:!0,className:"object-cover"}):(0,l.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400",children:"이미지 미리보기"})}),(0,l.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,l.jsx)("input",{type:"text",value:r,onChange:e=>o(e.target.value),placeholder:"제목",className:"border rounded p-2",required:!0}),(0,l.jsx)("table",{className:"text-base font-normal w-full",children:(0,l.jsxs)("tbody",{className:"[&>tr>td]:py-1 [&>tr>td:first-child]:pr-4",children:[(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:"일자"}),(0,l.jsx)("td",{children:(0,l.jsx)("input",{type:"date",value:c,onChange:e=>p(e.target.value),className:"border rounded p-1",required:!0})})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:"장소"}),(0,l.jsx)("td",{children:(0,l.jsx)("input",{type:"text",value:f,onChange:e=>x(e.target.value),className:"border rounded p-1 w-full",required:!0})})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:"플로리스트"}),(0,l.jsx)("td",{children:(0,l.jsx)("input",{type:"text",value:h,onChange:e=>m(e.target.value),placeholder:"이름1, 이름2 형식",className:"border rounded p-1 w-full",required:!0})})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:"간단 설명"}),(0,l.jsx)("td",{children:(0,l.jsx)("input",{type:"text",value:b,onChange:e=>g(e.target.value),placeholder:"간단한 설명을 입력해주세요",className:"border rounded p-1 w-full",required:!0})})]})]})})]})]}),(0,l.jsxs)("div",{className:"tiptap",children:[(0,l.jsx)("label",{className:"block mb-2 text-sm text-gray-600",children:"본문 내용"}),(0,l.jsx)("div",{className:"border border-gray-300 rounded min-h-[300px] bg-white",children:(0,l.jsx)(d.$Z,{editor:P})}),(0,l.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"※ 이미지는 드래그 앤 드롭으로 추가할 수 있습니다."})]}),(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;return w((null==(t=e.target.files)?void 0:t[0])||null)},className:"border p-2 rounded file:bg-[#E34798] file:text-white file:px-4 file:py-2 file:rounded file:border-none"}),(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-400 text-white rounded",onClick:()=>e.back(),disabled:_,children:"돌아가기"}),(0,l.jsx)("button",{type:"submit",className:"px-4 py-2 bg-[#E34798] text-white rounded",disabled:_,children:_?"저장 중...":"저장"})]})]})]})})}},6654:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return a}});let l=r(2115);function a(e,t){let r=(0,l.useRef)(null),a=(0,l.useRef)(null);return(0,l.useCallback)(l=>{if(null===l){let e=r.current;e&&(r.current=null,e());let t=a.current;t&&(a.current=null,t())}else e&&(r.current=n(e,l)),t&&(a.current=n(t,l))},[e,t])}function n(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6766:(e,t,r)=>{"use strict";r.d(t,{default:()=>a.a});var l=r(1469),a=r.n(l)}},e=>{var t=t=>e(e.s=t);e.O(0,[5004,277,3063,2980,8441,1684,7358],()=>t(3701)),_N_E=e.O()}]);